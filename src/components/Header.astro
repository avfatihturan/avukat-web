---
import { Image } from 'astro:assets';
import { getEntry } from 'astro:content'; // Veriyi JSON'dan çekmek için
import ThemeToggle from './ThemeToggle.astro';
import logoImage from '../assets/images/transparent-logo.png';

interface Props {
  currentPage?: string;
}

const { currentPage = '' } = Astro.props;

// 1. Veriyi site.json'dan çekiyoruz
const siteEntry = await getEntry('site', 'main');

// Güvenlik: Veri yoksa varsayılan değer kullan (Site çökmesin)
const siteData = siteEntry ? siteEntry.data : { name: 'Av. Fatih Turan', title: 'Hukuk Bürosu' };

// 2. Menüyü buraya sabitliyoruz (Bağımlılığı bitirmek için)
const NAV_ITEMS = [
  { label: 'Ana Sayfa', href: '/', id: 'home' },
  { label: 'Hakkımda', href: '/hakkimda', id: 'about' },
  { label: 'Çalışma Alanları', href: '/calisma-alanlari', id: 'work-areas' },
  { label: 'Yayınlar', href: '/yayinlar', id: 'blog' },
  { label: 'İletişim', href: '/iletisim', id: 'contact' },
];
---

<header>
  <div class="container header-row">
    <a href="/" class="brand-area">
      <Image src={logoImage} alt={`${siteData.name} Logosu`} width={55} height={55} loading="eager" />
      <div class="brand-text">
        <span class="name">{siteData.name}</span>
        <span class="title">{siteData.title}</span>
      </div>
    </a>
    <div class="header-right">
      <nav class="desktop-nav">
        <ul>
          {NAV_ITEMS.map((item) => (
            <li>
              <a
                href={item.href}
                class:list={[{ active: currentPage === item.id }]}
                aria-current={currentPage === item.id ? 'page' : undefined}
              >
                {item.label}
              </a>
            </li>
          ))}
        </ul>
      </nav>
      <ThemeToggle />
      <button class="menu-toggle" aria-label="Menüyü aç" aria-expanded="false">
        <i class="fa-solid fa-bars"></i>
      </button>
    </div>
  </div>
</header>