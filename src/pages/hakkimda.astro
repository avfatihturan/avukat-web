---
import BaseLayout from '../layouts/BaseLayout.astro';
import Hero from '../components/Hero.astro';
import { getEntry } from 'astro:content';

type AboutData = {
  paragraphs: string[];
  signature?: {
    name?: string;
    bar?: string;
  };
};

const siteEntry = await getEntry('site', 'main');
if (!siteEntry) {
  throw new Error('Site verisi (site/main) bulunamadı.');
}

// ✅ about koleksiyonu YOK: data koleksiyonundan oku
const aboutEntry = await getEntry('data', 'about');
if (!aboutEntry) {
  throw new Error('Hakkımda sayfası için gerekli veriler (data/about.json) bulunamadı.');
}

const { name } = siteEntry.data as any;
const aboutData = aboutEntry.data as AboutData;

const paragraphs: string[] = Array.isArray(aboutData?.paragraphs) ? aboutData.paragraphs : [];
const signature = aboutData?.signature ?? {};
---

<BaseLayout
  title={`Hakkımda | ${name}`}
  description={`${name} hakkında bilgi. Disiplin, Strateji ve Hukuk vizyonu.`}
  currentPage="hakkimda"
  canonicalUrl="/hakkimda"
>
  <Hero title="Hakkımda" size="sm" />

  <section class="bg-light">
    <div class="container about-container">
      <h2 class="section-heading">Disiplin. Strateji. Hukuk.</h2>

      <div class="about-content">
        {paragraphs.map((paragraph: string) => (
          <p set:html={paragraph} />
        ))}

        <div class="about-signature">
          <p>
            <strong>{signature?.name}</strong><br />
            {signature?.bar}
          </p>
        </div>
      </div>
    </div>
  </section>
</BaseLayout>

<style>
  .about-container { max-width: 800px; margin: 0 auto; }
  .about-content { font-size: 1.15rem; text-align: justify; line-height: 1.8; color: var(--color-text); }
  .about-content p { margin-bottom: 1.5em; }
  .about-signature { margin-top: 40px; padding-top: 20px; border-top: 2px solid var(--brand-accent); width: fit-content; }
  .section-heading { margin-bottom: 40px; font-weight: 700; color: var(--brand-primary); }
  :global(html.dark) .section-heading { color: var(--color-text); }
</style>