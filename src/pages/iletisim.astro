---
import BaseLayout from '../layouts/BaseLayout.astro';
import Hero from '../components/Hero.astro';
import { getEntry } from 'astro:content';

const siteEntry = await getEntry('site', 'main');

if (!siteEntry) {
  throw new Error('Site verisi (site.json) bulunamadı!');
}

const { name, contact } = siteEntry.data;

const icons = {
  phone: "M164.9 24.6c-7.7-18.6-28-28.5-47.4-23.2l-88 24C12.1 30.2 0 46 0 64C0 311.4 200.6 512 448 512c18 0 33.8-12.1 38.6-29.5l24-88c5.3-19.4-4.6-39.7-23.2-47.4l-96-40c-16.3-6.8-35.2-2.1-46.3 11.6L304.7 368C234.3 334.7 177.3 277.7 144 207.3L193.3 167c13.7-11.2 18.4-30 11.6-46.3l-40-96z",
  whatsapp: "M380.9 97.1C339 55.1 283.2 32 224 32 102.4 32 3.2 131.2 3.2 252.8c0 39 10.2 77.1 29.6 110.7L0 480l119.3-31.2c32.8 17.9 69.8 27.3 107.7 27.3h.1c121.5 0 220.7-99.2 220.7-220.8 0-59.2-23.1-115-65.1-157.2zM224 438.7h-.1c-33.1 0-65.5-8.9-93.8-25.7l-6.7-4-70.8 18.5 18.9-69.1-4.4-7c-18.3-29.4-28-63.3-28-98.6 0-101.7 82.8-184.5 184.6-184.5 49.3 0 95.6 19.2 130.4 54.1 34.8 34.9 54 81.2 54 130.5 0 101.8-82.8 184.8-184.6 184.8zm101.2-138.3c-5.5-2.8-32.4-16-37.5-17.8-5.1-1.9-8.8-2.8-12.5 2.8-3.7 5.5-14.3 17.8-17.5 21.5-3.2 3.7-6.5 4.1-12 1.4-5.5-2.8-23.2-8.5-44.2-27.1-16.3-14.5-27.4-32.4-30.6-38-3.2-5.5-.3-8.5 2.4-11.2 2.5-2.5 5.5-6.5 8.3-9.6 2.8-3.2 3.7-5.5 5.5-9.2 1.9-3.7.9-6.9-.5-9.6-1.4-2.8-12.5-30.1-17.1-41.2-4.5-10.9-9.1-9.4-12.5-9.6-3.2-.2-6.9-.2-10.6-.2-3.7 0-9.6 1.4-14.6 6.9-5 5.5-19.1 18.7-19.1 45.7 0 27 19.6 53.1 22.4 56.8 2.8 3.7 38.5 58.8 93.4 82.5 13.1 5.6 23.3 9 31.2 11.5 13.1 4.2 25.1 3.6 34.6 2.2 10.6-1.6 32.4-13.2 37-26 4.6-12.7 4.6-23.6 3.2-26-1.4-2.4-5-3.7-10.5-6.4z",
  envelope: "M64 112c-8.8 0-16 7.2-16 16v22.1L220.5 291.7c20.7 17 50.4 17 71.1 0L464 150.1V128c0-8.8-7.2-16-16-16H64zM48 212.2V384c0 8.8 7.2 16 16 16H448c8.8 0 16-7.2 16-16V212.2L322 328.8c-38.4 31.5-93.7 31.5-132 0L48 212.2zM0 128C0 92.7 28.7 64 64 64H448c35.3 0 64 28.7 64 64V384c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V128z",
};
---

<BaseLayout
  title={`İletişim | ${name}`}
  description={`${name} ile iletişime geçin. Hukuki danışmanlık ve randevu talebi oluşturun.`}
  currentPage="iletisim"
  canonicalUrl="/iletisim"
>
  <Hero
    title="İletişim"
    size="sm"
    image="/images/banner-contact.webp"
  />

  <section class="bg-light">
    <div class="container">
      <div class="contact-grid">
        <a href={contact.phoneLink} class="contact-card">
          <div class="icon-box">
            <svg viewBox="0 0 512 512" width="34" height="34" fill="currentColor" aria-hidden="true">
              <path d={icons.phone} />
            </svg>
          </div>
          <span class="contact-card__label">Telefon</span>
          <span class="contact-card__value">{contact.phone}</span>
        </a>

        <a href={`https://wa.me/${contact.whatsapp}`} target="_blank" rel="noopener noreferrer" class="contact-card">
          <div class="icon-box">
            <svg viewBox="0 0 448 512" width="34" height="34" fill="currentColor" aria-hidden="true">
              <path d={icons.whatsapp} />
            </svg>
          </div>
          <span class="contact-card__label">WhatsApp</span>
          <span class="contact-card__value">Mesaj Gönderin</span>
        </a>

        <a href={`mailto:${contact.email}`} class="contact-card">
          <div class="icon-box">
            <svg viewBox="0 0 512 512" width="34" height="34" fill="currentColor" aria-hidden="true">
              <path d={icons.envelope} />
            </svg>
          </div>
          <span class="contact-card__label">E-posta</span>
          <span class="contact-card__value">{contact.email}</span>
        </a>
      </div>

      <div class="form-wrapper">
        <h2 class="section-heading" style="font-size: 1.8rem; margin-bottom: 20px;">Randevu Talep Formu</h2>

        <p class="form-intro">
          Hukuki danışmanlık talepleriniz için aşağıdaki formu doldurabilirsiniz.
          Müsaitlik durumuna göre size en kısa sürede geri dönüş yapılacaktır.
        </p>

        <div class="form-meta">
          <span class="required-note"><span class="req">*</span> Zorunlu alan</span>
        </div>

        <form action="https://formspree.io/f/xankgjed" method="POST" class="contact-form">
          <!-- SPAM KORUMA (Honeypot): botlar doldurur, gerçek kullanıcı görmez -->
          <div class="hp-wrap" aria-hidden="true">
            <label for="website">Website</label>
            <input id="website" type="text" name="_gotcha" tabindex="-1" autocomplete="off" />
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="adsoyad">Adınız Soyadınız <span class="req">*</span></label>
              <input id="adsoyad" type="text" name="adsoyad" placeholder="Ad Soyad" required />
            </div>

            <div class="form-group">
              <label for="telefon">Telefon Numaranız <span class="req">*</span></label>
              <input id="telefon" type="tel" name="telefon" placeholder="05XX XXX XX XX" required inputmode="tel" />
            </div>
          </div>

          <div class="form-group">
            <label for="email">E-posta Adresiniz <span class="req">*</span></label>
            <input id="email" type="email" name="email" placeholder="ornek@email.com" required inputmode="email" />
          </div>

          <div class="form-group">
            <label class="label-block">Görüşme İçin Uygun Olduğunuz Tarihler (3 Alternatif)</label>
            <div class="date-grid">
              <input type="date" name="tarih_tercih_1" aria-label="1. Tercih" />
              <input type="date" name="tarih_tercih_2" aria-label="2. Tercih" />
              <input type="date" name="tarih_tercih_3" aria-label="3. Tercih" />
            </div>
          </div>

          <div class="form-group">
            <label for="mesaj">Konu / Hukuki Sorun Özeti <span class="req">*</span></label>
            <textarea id="mesaj" name="mesaj" rows="5" placeholder="Danışmak istediğiniz konuyu kısaca özetleyiniz..." required></textarea>
          </div>

          <div class="checkbox-group fee-warning">
            <input type="checkbox" name="ucret_onayi" id="ucret_onayi" value="Kabul Edildi" required />
            <label for="ucret_onayi">
              <strong>Danışmanlık Ücreti Onayı <span class="req">*</span>:</strong>
              Ofisimizde veya online yapılacak görüşmelerin, Avukatlık Asgari Ücret Tarifesi gereğince
              <strong>ücrete tabi olduğunu</strong> biliyor ve kabul ediyorum.
            </label>
          </div>

          <div class="checkbox-group">
            <input type="checkbox" name="kvkk_onayi" id="kvkk_onayi" value="Okudum" required />
            <label for="kvkk_onayi">
              <a href="/kvkk-aydinlatma-metni" target="_blank" style="text-decoration: underline;">KVKK Aydınlatma Metni</a>'ni okudum. <span class="req">*</span>
            </label>
          </div>

          <button type="submit" class="btn">Talep Gönder</button>
        </form>
      </div>
    </div>
  </section>
</BaseLayout>

<style>
  .contact-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 30px;
    margin-bottom: 60px;
  }
  @media (max-width: 768px) {
    .contact-grid { grid-template-columns: 1fr; gap: 20px; }
  }

  .contact-card {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    padding: 35px 20px;
    background: var(--card-bg);
    border: 1px solid var(--color-border);
    border-radius: 12px;
    text-decoration: none;
    transition: all 0.3s ease;
  }
  .contact-card:hover {
    border-color: var(--brand-accent);
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.06);
  }

  .icon-box {
    margin-bottom: 15px;
    color: var(--brand-accent);
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .icon-box svg {
    display: block;
    opacity: 1;
    filter: drop-shadow(0 1px 2px rgba(0,0,0,0.10));
  }
  :global(html.dark) .icon-box svg {
    filter: drop-shadow(0 2px 6px rgba(197,160,89,0.35));
  }

  .contact-card__label {
    font-size: 0.85rem;
    text-transform: uppercase;
    font-weight: 700;
    letter-spacing: 1px;
    color: var(--color-text-secondary);
    margin-bottom: 8px;
  }

  .contact-card__value {
    font-size: 1.1rem;
    font-weight: 600;
    color: var(--brand-primary);
  }
  :global(html.dark) .contact-card__value { color: var(--color-text); }

  .form-wrapper {
    max-width: 800px;
    margin: 0 auto;
    background: var(--card-bg);
    padding: 40px;
    border-radius: 16px;
    border: 1px solid var(--color-border);
    box-shadow: 0 4px 20px rgba(0,0,0,0.05);
  }
  @media (max-width: 600px) { .form-wrapper { padding: 22px; } }

  .form-intro{
    margin-bottom: 18px;
    color: var(--color-text-secondary);
  }

  .form-meta{
    display:flex;
    justify-content:flex-start;
    margin-bottom: 18px;
  }

  .required-note{
    font-size: .92rem;
    color: var(--color-text-secondary);
  }

  .req{
    color: #dc2626;
    font-weight: 800;
    margin-left: 2px;
  }

  .form-group { margin-bottom: 18px; }

  .form-group label {
    display: block;
    margin-bottom: 8px;
    font-weight: 650;
    font-size: 0.95rem;
    color: var(--brand-primary);
  }
  :global(html.dark) .form-group label { color: var(--color-text); }

  .label-block{ display:block; margin-bottom: 10px; }

  .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 16px; }
  @media (max-width: 700px) { .form-row { grid-template-columns: 1fr; } }

  .date-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; }
  @media (max-width: 700px) { .date-grid { grid-template-columns: 1fr; } }

  /* FORM INPUTS — premium + mobile-friendly */
  input[type="text"],
  input[type="email"],
  input[type="tel"],
  input[type="date"],
  textarea {
    width: 100%;
    padding: 14px 14px;
    border: 1px solid var(--input-border);
    background-color: var(--input-bg);
    border-radius: 12px;
    font-family: inherit;
    font-size: 16px; /* iOS zoom engeli */
    color: var(--color-text);
    transition: 0.2s;
  }

  input[type="text"],
  input[type="email"],
  input[type="tel"],
  input[type="date"]{
    height: 48px;
  }

  textarea{
    min-height: 140px;
    resize: vertical;
  }

  input:focus, textarea:focus {
    outline: none;
    border-color: var(--brand-accent);
    box-shadow: 0 0 0 3px rgba(197, 160, 89, 0.10);
    background: var(--card-bg);
  }

  /* Mobilde “çok büyük” hissini düzelt */
  @media (max-width: 600px){
    input[type="text"],
    input[type="email"],
    input[type="tel"],
    input[type="date"],
    textarea{
      padding: 12px 12px;
      border-radius: 12px;
    }

    input[type="text"],
    input[type="email"],
    input[type="tel"],
    input[type="date"]{
      height: 44px;
    }

    textarea{
      min-height: 132px;
    }
  }

  .checkbox-group {
    display: grid;
    grid-template-columns: 20px 1fr;
    gap: 12px;
    margin: 14px 0;
    font-size: 0.92rem;
    line-height: 1.55;
    align-items: start;
  }

  .checkbox-group input {
    margin-top: 4px;
    accent-color: var(--brand-accent);
    width: 18px;
    height: 18px;
  }

  .fee-warning {
    background-color: rgba(197, 160, 89, 0.10);
    padding: 14px;
    border-left: 4px solid var(--brand-accent);
    border-radius: 10px;
  }
  :global(html.dark) .fee-warning { background-color: rgba(197, 160, 89, 0.06); }

  .btn { width: 100%; margin-top: 10px; }

  /* Honeypot: ekranda görünmesin, botlar görür */
  .hp-wrap{
    position:absolute !important;
    left:-10000px !important;
    top:auto !important;
    width:1px !important;
    height:1px !important;
    overflow:hidden !important;
  }
</style>